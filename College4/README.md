Dotnot function adapted from code by Teun Bergsma.
